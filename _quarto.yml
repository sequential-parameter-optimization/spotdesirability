# SPDX-FileCopyrightText: 2026 bartzbeielstein
#
# SPDX-License-Identifier: GPL-2.0-or-later
#
# =============================================================================
# _quarto.yml  —  spotdesirability Documentation
# =============================================================================
# Master project configuration for Quarto.
#
# Build pipeline:
#   1. quartodoc build     → docs/reference/*.qmd  (API autodoc)
#   2. quarto render       → _site/  (full HTML site)
#   3. quarto publish      → gh-pages branch
#
# ⚠️ Safety-critical note: pin Quarto and quartodoc versions in CI to
#     guarantee reproducible renders across audit cycles.
# =============================================================================

jupyter: spotdesirability

project:
  type: website
  output-dir: _site

  # Explicitly allowlist what gets rendered.
  render:
    - "index.qmd"
    - "about.qmd"
    - "cookbook.qmd"
    - "download.qmd"
    - "examples.qmd"
    - "docs/reference/**/*.qmd"

filters:
  - docs/interlinks.lua

interlinks:
  sources:
    python:
      url: "https://docs.python.org/3/"
    pandas:
      url: "https://pandas.pydata.org/docs/"
    numpy:
      url: "https://numpy.org/doc/stable/"

# Website metadata & navigation
# =============================================================================
website:
  title: "spotdesirability"
  description: "Python implementation of desirability functions for multivariate optimisation"
  site-url: "https://sequential-parameter-optimization.github.io/spotdesirability/"
  repo-url: "https://github.com/sequential-parameter-optimization/spotdesirability"
  repo-actions: [edit, issue]

  # ── Minimal top bar (search + GitHub icon only) ───────────────────────────
  navbar:
    background: primary
    search: true
    right:
      - icon: github
        href: "https://github.com/sequential-parameter-optimization/spotdesirability"
        aria-label: "GitHub repository"

  # ── Left sidebar (primary navigation) ────────────────────────────────────
  sidebar:
    style: "docked"       # matches MkDocs Material "navigation.sections" feel
    search: false         # already in navbar
    collapse-level: 1     # top-level sections default to collapsed
    contents:
      - text: "Home"
        file: index.qmd
      - section: "Getting Started"
        contents:
          - download.qmd
          - examples.qmd
      - section: "Guides"
        contents:
          - cookbook.qmd
      - section: "About"
        contents:
          - about.qmd
          - SECURITY.md
          - CHANGELOG.md

      - section: "API Reference"
        contents:
          - text: "Overview"
            file: docs/reference/index.qmd
          - section: "Desirability Classes"
            contents:
              - text: "utils"
                file: docs/reference/utils.qmd
              - text: "utils.desirability"
                file: docs/reference/utils.desirability.qmd
              - text: "DesirabilityBase"
                file: docs/reference/utils.desirability.DesirabilityBase.qmd
              - text: "DMax"
                file: docs/reference/utils.desirability.DMax.qmd
              - text: "DMin"
                file: docs/reference/utils.desirability.DMin.qmd
              - text: "DTarget"
                file: docs/reference/utils.desirability.DTarget.qmd
              - text: "DArb"
                file: docs/reference/utils.desirability.DArb.qmd
              - text: "DBox"
                file: docs/reference/utils.desirability.DBox.qmd
              - text: "DCategorical"
                file: docs/reference/utils.desirability.DCategorical.qmd
              - text: "DOverall"
                file: docs/reference/utils.desirability.DOverall.qmd
          - section: "RSM Functions"
            contents:
              - text: "functions"
                file: docs/reference/functions.qmd
              - text: "functions.rsm"
                file: docs/reference/functions.rsm.qmd
              - text: "conversion_pred"
                file: docs/reference/functions.rsm.conversion_pred.qmd
              - text: "activity_pred"
                file: docs/reference/functions.rsm.activity_pred.qmd
              - text: "rsm_opt"
                file: docs/reference/functions.rsm.rsm_opt.qmd
          - section: "Plotting"
            contents:
              - text: "plot"
                file: docs/reference/plot.qmd
              - text: "plot.ccd"
                file: docs/reference/plot.ccd.qmd
              - text: "plotCCD"
                file: docs/reference/plot.ccd.plotCCD.qmd
          - section: "Data Utilities"
            contents:
              - text: "data_utils"
                file: docs/reference/data_utils.qmd
              - text: "get_data_folder_path"
                file: docs/reference/data_utils.get_data_folder_path.qmd

  # ── Page footer ───────────────────────────────────────────────────────────
  page-footer:
    center: |
      Copyright © 2004-2026 Thomas Bartz-Beielstein |
      [AGPL-3.0-or-later](https://www.gnu.org/licenses/agpl-3.0.html)

  search:
    location: navbar
    type: overlay

# =============================================================================
# HTML output format
# =============================================================================
format:
  html:
    theme:
      light: cosmo
      dark: darkly
    toc: true
    toc-depth: 3
    toc-location: right
    code-copy: true
    code-fold: false
    highlight-style: github
    # Math: built-in MathJax allows $...$ and $$...$$ directly
    html-math-method: mathjax
    smooth-scroll: true
    link-external-icon: true
    link-external-newwindow: true

# =============================================================================
# quartodoc — API reference generation
# =============================================================================
quartodoc:
  package: spotdesirability
  source_dir: src
  dir: docs/reference
  parser: google
  render_interlinks: true
  
  # CRITICAL FIX: The next two parameters force quartodoc to generate pages 
  # for underlying module classes/functions.
  options:
    children: linked

  # This section lists all top-level targets.
  sections:
    - title: "Desirability Classes"
      contents:
        - utils
        - utils.desirability
        - utils.desirability.DesirabilityBase
        - utils.desirability.DMax
        - utils.desirability.DMin
        - utils.desirability.DTarget
        - utils.desirability.DArb
        - utils.desirability.DBox
        - utils.desirability.DCategorical
        - utils.desirability.DOverall
    - title: "RSM Functions"
      contents:
        - functions
        - functions.rsm
        - functions.rsm.conversion_pred
        - functions.rsm.activity_pred
        - functions.rsm.rsm_opt
    - title: "Plotting"
      contents:
        - plot
        - plot.ccd
        - plot.ccd.plotCCD
    - title: "Data Utilities"
      contents:
        - data_utils
        - data_utils.get_data_folder_path
